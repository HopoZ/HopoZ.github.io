var RoughNotation=(t=>{let p="http://www.w3.org/2000/svg";class e{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}function _(t,e,s,i,r){return{type:"path",ops:o(t,e,s,i,r)}}function v(s,t,i){var r=(s||[]).length;if(2<r){let e=[];for(let t=0;t<r-1;t++)e.push(...o(s[t][0],s[t][1],s[t+1][0],s[t+1][1],i));return t&&e.push(...o(s[r-1][0],s[r-1][1],s[0][0],s[0][1],i)),{type:"path",ops:e}}return 2===r?_(s[0][0],s[0][1],s[1][0],s[1][1],i):{type:"path",ops:[]}}function m(t,e,s,i,r){return v([[t,e],[t+s,e],[t+s,e+i],[t,e+i]],!0,r)}function w(t,e,s,i,r){return((s,i,r,n)=>{let[t,e]=c(n.increment,s,i,n.rx,n.ry,1,n.increment*a(.1,a(.4,1,r),r),r),h=u(t,null,r);if(!r.disableMultiStroke){let[t]=c(n.increment,s,i,n.rx,n.ry,1.5,0,r),e=u(t,null,r);h=h.concat(e)}return{estimatedPoints:e,opset:{type:"path",ops:h}}})(t,e,r,(t=s,e=i,s=r,i=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),i=Math.max(s.curveStepCount,s.curveStepCount/Math.sqrt(200)*i),i=2*Math.PI/i,t=Math.abs(t/2),e=Math.abs(e/2),r=1-s.curveFitting,{increment:i,rx:t+=y(t*r,s),ry:e+=y(e*r,s)})).opset}function b(t){return t.randomizer||(t.randomizer=new e(t.seed||0)),t.randomizer.next()}function a(t,e,s,i=1){return s.roughness*i*(b(s)*(e-t)+t)}function y(t,e,s=1){return a(-t,t,e,s)}function o(t,e,s,i,r,n=!1){var n=n?r.disableMultiStrokeFill:r.disableMultiStroke,h=l(t,e,s,i,r,!0,!1);return n?h:(n=l(t,e,s,i,r,!0,!0),h.concat(n))}function l(t,e,s,i,r,n,h){var a=Math.pow(t-s,2)+Math.pow(e-i,2),o=Math.sqrt(a);let l,u=(l=o<200?1:500<o?.4:-.0016668*o+1.233334,r.maxRandomnessOffset||0),c=(u=u*u*100>a?o/10:u)/2,f=.2+.2*b(r);var a=r.bowing*r.maxRandomnessOffset*(t-s)/200,o=y(r.bowing*r.maxRandomnessOffset*(i-e)/200,r,l),a=y(a,r,l),g=[],d=()=>y(c,r,l),p=()=>y(u,r,l);return n&&g.push(h?{op:"move",data:[t+d(),e+d()]}:{op:"move",data:[t+y(u,r,l),e+y(u,r,l)]}),g.push(h?{op:"bcurveTo",data:[o+t+(s-t)*f+d(),a+e+(i-e)*f+d(),o+t+2*(s-t)*f+d(),a+e+2*(i-e)*f+d(),s+d(),i+d()]}:{op:"bcurveTo",data:[o+t+(s-t)*f+p(),a+e+(i-e)*f+p(),o+t+2*(s-t)*f+p(),a+e+2*(i-e)*f+p(),s+p(),i+p()]}),g}function u(s,e,i){var t=s.length,r=[];if(3<t){var n=[],h=1-i.curveTightness;r.push({op:"move",data:[s[1][0],s[1][1]]});for(let e=1;e+2<t;e++){let t=s[e];n[0]=[t[0],t[1]],n[1]=[t[0]+(h*s[e+1][0]-h*s[e-1][0])/6,t[1]+(h*s[e+1][1]-h*s[e-1][1])/6],n[2]=[s[e+1][0]+(h*s[e][0]-h*s[e+2][0])/6,s[e+1][1]+(h*s[e][1]-h*s[e+2][1])/6],n[3]=[s[e+1][0],s[e+1][1]],r.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[3][0],n[3][1]]})}if(e&&2===e.length){let t=i.maxRandomnessOffset;r.push({op:"lineTo",data:[e[0]+y(t,i),e[1]+y(t,i)]})}}else 3===t?(r.push({op:"move",data:[s[1][0],s[1][1]]}),r.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[2][0],s[2][1]]})):2===t&&r.push(...o(s[0][0],s[0][1],s[1][0],s[1][1],i));return r}function c(t,s,i,r,n,h,e,a){var o=[],l=[],u=y(.5,a)-Math.PI/2;l.push([y(h,a)+s+.9*r*Math.cos(u-t),y(h,a)+i+.9*n*Math.sin(u-t)]);for(let e=u;e<2*Math.PI+u-.01;e+=t){let t=[y(h,a)+s+r*Math.cos(e),y(h,a)+i+n*Math.sin(e)];o.push(t),l.push(t)}return l.push([y(h,a)+s+r*Math.cos(u+2*Math.PI+.5*e),y(h,a)+i+n*Math.sin(u+2*Math.PI+.5*e)]),l.push([y(h,a)+s+.98*r*Math.cos(u+e),y(h,a)+i+.98*n*Math.sin(u+e)]),l.push([y(h,a)+s+.9*r*Math.cos(u+.5*e),y(h,a)+i+.9*n*Math.sin(u+.5*e)]),[l,o]}function k(t,e){return{maxRandomnessOffset:2,roughness:"highlight"===t?3:1.5,bowing:1,stroke:"#000",strokeWidth:1.5,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,combineNestedSvgPaths:!1,disableMultiStroke:"double"!==t,disableMultiStrokeFill:!1,seed:e}}function f(i,o,h,u,c,t){let f=[],r=h.strokeWidth||2;var l=(t=>{var e=t.padding;if(e||0===e){if("number"==typeof e)return[e,e,e,e];if(Array.isArray(e)){let t=e;if(t.length)switch(t.length){case 4:return[...t];case 1:return[t[0],t[0],t[0],t[0]];case 2:return[...t,...t];case 3:return[...t,t[1]];default:return[t[0],t[1],t[2],t[3]]}}}return[5,5,5,5]})(h),n=void 0===h.animate||!!h.animate,g=h.iterations||2,a=h.rtl?1:0,d=k("single",t);switch(h.type){case"underline":{let e=o.y+o.h+l[2];for(let t=a;t<g+a;t++)t%2?f.push(_(o.x+o.w,e,o.x,e,d)):f.push(_(o.x,e,o.x+o.w,e,d));break}case"strike-through":{let e=o.y+o.h/2;for(let t=a;t<g+a;t++)t%2?f.push(_(o.x+o.w,e,o.x,e,d)):f.push(_(o.x,e,o.x+o.w,e,d));break}case"box":{let e=o.x-l[3],s=o.y-l[0],i=o.w+(l[1]+l[3]),r=o.h+(l[0]+l[2]);for(let t=0;t<g;t++)f.push(m(e,s,i,r,d));break}case"bracket":{let t=Array.isArray(h.brackets)?h.brackets:h.brackets?[h.brackets]:["right"],s=o.x-2*l[3],i=o.x+o.w+2*l[1],r=o.y-2*l[0],n=o.y+o.h+2*l[2];for(let e of t){let t;switch(e){case"bottom":t=[[s,o.y+o.h],[s,n],[i,n],[i,o.y+o.h]];break;case"top":t=[[s,o.y],[s,r],[i,r],[i,o.y]];break;case"left":t=[[o.x,r],[s,r],[s,n],[o.x,n]];break;case"right":t=[[o.x+o.w,r],[i,r],[i,n],[o.x+o.w,n]]}t&&f.push(v(t,!1,d))}break}case"crossed-off":{let e=o.x,s=o.y,i=e+o.w,r=s+o.h;for(let t=a;t<g+a;t++)t%2?f.push(_(i,r,e,s,d)):f.push(_(e,s,i,r,d));for(let t=a;t<g+a;t++)t%2?f.push(_(e,r,i,s,d)):f.push(_(i,s,e,r,d));break}case"circle":{let e=k("double",t),s=o.w+(l[1]+l[3]),i=o.h+(l[0]+l[2]),r=o.x-l[3]+s/2,n=o.y-l[0]+i/2,h=Math.floor(g/2),a=g-2*h;for(let t=0;t<h;t++)f.push(w(r,n,s,i,e));for(let t=0;t<a;t++)f.push(w(r,n,s,i,d));break}case"highlight":{let e=k("highlight",t),s=(r=.95*o.h,o.y+o.h/2);for(let t=a;t<g+a;t++)t%2?f.push(_(o.x+o.w,s,o.x,s,e)):f.push(_(o.x,s,o.x+o.w,s,e));break}}if(f.length){let e=(()=>{var e,s=[];for(e of f){let t="";for(var i of e.ops){var r=i.data;switch(i.op){case"move":t.trim()&&s.push(t.trim()),t=`M${r[0]} ${r[1]} `;break;case"bcurveTo":t+=`C${r[0]} ${r[1]}, ${r[2]} ${r[3]}, ${r[4]} ${r[5]} `;break;case"lineTo":t+=`L${r[0]} ${r[1]} `}}t.trim()&&s.push(t.trim())}return s})(),a=[],o=[],l=0,s=(t,e,s)=>t.setAttribute(e,s);for(let t of e){let e=document.createElementNS(p,"path");if(s(e,"d",t),s(e,"fill","none"),s(e,"stroke",h.color||"currentColor"),s(e,"stroke-width",""+r),n){let t=e.getTotalLength();a.push(t),l+=t}i.appendChild(e),o.push(e)}if(n){let h=0;for(let n=0;n<o.length;n++){let t=o[n],e=a[n],s=l?c*(e/l):0,i=u+h,r=t.style;r.strokeDashoffset=""+e,r.strokeDasharray=""+e,r.animation=`rough-notation-dash ${s}ms ease-out ${i}ms forwards`,h+=s}}}}class s{constructor(t,e){this._state="unattached",this._resizing=!1,this._seed=Math.floor(Math.random()*2**31),this._lastSizes=[],this._animationDelay=0,this._resizeListener=()=>{this._resizing||(this._resizing=!0,setTimeout(()=>{this._resizing=!1,"showing"===this._state&&this.haveRectsChanged()&&this.show()},400))},this._e=t,this._config=JSON.parse(JSON.stringify(e)),this.attach()}get animate(){return this._config.animate}set animate(t){this._config.animate=t}get animationDuration(){return this._config.animationDuration}set animationDuration(t){this._config.animationDuration=t}get iterations(){return this._config.iterations}set iterations(t){this._config.iterations=t}get color(){return this._config.color}set color(t){this._config.color!==t&&(this._config.color=t,this.refresh())}get strokeWidth(){return this._config.strokeWidth}set strokeWidth(t){this._config.strokeWidth!==t&&(this._config.strokeWidth=t,this.refresh())}get padding(){return this._config.padding}set padding(t){this._config.padding!==t&&(this._config.padding=t,this.refresh())}attach(){var t,e;"unattached"===this._state&&this._e.parentElement&&(window.__rno_kf_s||((e=window.__rno_kf_s=document.createElement("style")).textContent="@keyframes rough-notation-dash { to { stroke-dashoffset: 0; } }",document.head.appendChild(e)),(e=this._svg=document.createElementNS(p,"svg")).setAttribute("class","rough-annotation"),(t=e.style).position="absolute",t.top="0",t.left="0",t.overflow="visible",t.pointerEvents="none",t.width="100px",t.height="100px",t="highlight"===this._config.type,this._e.insertAdjacentElement(t?"beforebegin":"afterend",e),this._state="not-showing",!t||(t=window.getComputedStyle(this._e).position)&&"static"!==t||(this._e.style.position="relative"),this.attachListeners())}detachListeners(){window.removeEventListener("resize",this._resizeListener),this._ro&&this._ro.unobserve(this._e)}attachListeners(){this.detachListeners(),window.addEventListener("resize",this._resizeListener,{passive:!0}),!this._ro&&"ResizeObserver"in window&&(this._ro=new window.ResizeObserver(t=>{for(var e of t)e.contentRect&&this._resizeListener()})),this._ro&&this._ro.observe(this._e)}haveRectsChanged(){if(this._lastSizes.length){var e=this.rects();if(e.length!==this._lastSizes.length)return!0;for(let t=0;t<e.length;t++)if(!this.isSameRect(e[t],this._lastSizes[t]))return!0}return!1}isSameRect(t,e){var s=(t,e)=>Math.round(t)===Math.round(e);return s(t.x,e.x)&&s(t.y,e.y)&&s(t.w,e.w)&&s(t.h,e.h)}isShowing(){return"not-showing"!==this._state}refresh(){this.isShowing()&&!this.pendingRefresh&&(this.pendingRefresh=Promise.resolve().then(()=>{this.isShowing()&&this.show(),delete this.pendingRefresh}))}show(){switch(this._state){case"unattached":break;case"showing":this.hide(),this._svg&&this.render(this._svg,!0);break;case"not-showing":this.attach(),this._svg&&this.render(this._svg,!1)}}hide(){if(this._svg)for(;this._svg.lastChild;)this._svg.removeChild(this._svg.lastChild);this._state="not-showing"}remove(){this._svg&&this._svg.parentElement&&this._svg.parentElement.removeChild(this._svg),this._svg=void 0,this._state="unattached",this.detachListeners()}render(e,t){let s=this._config;t&&((s=JSON.parse(JSON.stringify(this._config))).animate=!1);var i=this.rects();let r=0;i.forEach(t=>r+=t.w);var n=s.animationDuration||800;let h=0;for(let t=0;t<i.length;t++){var a=n*(i[t].w/r);f(e,i[t],s,h+this._animationDelay,a,this._seed),h+=a}this._lastSizes=i,this._state="showing"}rects(){var e=[];if(this._svg)if(this._config.multiline){var s=this._e.getClientRects();for(let t=0;t<s.length;t++)e.push(this.svgRect(this._svg,s[t]))}else e.push(this.svgRect(this._svg,this._e.getBoundingClientRect()));return e}svgRect(t,e){t=t.getBoundingClientRect();return{x:(e.x||e.left)-(t.x||t.left),y:(e.y||e.top)-(t.y||t.top),w:e.width,h:e.height}}}return t.annotate=function(t,e){return new s(t,e)},t.annotationGroup=function(t){let s=0;for(let e of t){let t=e;t._animationDelay=s,s+=0===t.animationDuration?0:t.animationDuration||800}let e=[...t];return{show(){for(var t of e)t.show()},hide(){for(var t of e)t.hide()}}},Object.defineProperty(t,"__esModule",{value:!0}),t})({});